{% extends "base.html" %}
{% block title %}Message {{ recipient.name }}{% endblock %}
{% block content %}
<div class="bg-white shadow-xl rounded-xl p-8 max-w-2xl mx-auto">
    <div class="mb-6">
        <h1 class="text-3xl font-bold text-gray-900 mb-2">Message {{ recipient.name }}</h1>
        <p class="text-gray-600">{{ recipient.email }}</p>
    </div>
    
    {% if existing_thread %}
    <div class="mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg">
        <p class="text-sm text-blue-800">
            <i class="fas fa-info-circle mr-2"></i>
            You have an existing conversation with {{ recipient.name }}.
            <a href="{{ url_for('messages.view_thread', thread_id=existing_thread) }}" class="text-blue-600 hover:text-blue-800 underline ml-2">
                View conversation â†’
            </a>
        </p>
    </div>
    {% endif %}
    
    <form method="POST" action="{{ url_for('messages.message_user', user_id=recipient.user_id) }}" class="space-y-4">
        {{ form.hidden_tag() }}
        <div>
            {{ form.content.label(class_='block text-sm font-medium text-gray-700 mb-2') }}
            {{ form.content(class_='w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500', placeholder='Type your message here...') }}
            {% for error in form.content.errors %}
                <p class="text-sm text-red-600 mt-1">{{ error }}</p>
            {% endfor %}
        </div>
        <div class="flex gap-4">
            {{ form.submit(class_='bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 font-semibold transition') }}
            <a href="{{ url_for('resources.list_resources') }}" class="bg-gray-300 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-400 font-semibold transition">
                Cancel
            </a>
        </div>
    </form>
</div>
{% endblock %}

