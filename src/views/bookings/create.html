{% extends "base.html" %}
{% block title %}Book Resource{% endblock %}
{% block content %}
<div class="bg-white shadow-xl rounded-xl p-8 max-w-2xl mx-auto">
    <h1 class="text-3xl font-bold text-gray-900 mb-2">Book: {{ resource.title }}</h1>
    <p class="text-gray-600 mb-6">{{ resource.location }}</p>
    
    <form method="POST" action="{{ url_for('bookings.create_booking', resource_id=resource.resource_id) }}" class="space-y-6">
        {{ form.hidden_tag() }}
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <label for="start_datetime" class="block text-sm font-medium text-gray-700 mb-1">Start Date & Time</label>
                <input type="datetime-local" id="start_datetime" name="start_datetime" required 
                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
            </div>
            <div>
                <label for="end_datetime" class="block text-sm font-medium text-gray-700 mb-1">End Date & Time</label>
                <input type="datetime-local" id="end_datetime" name="end_datetime" required 
                       class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
            </div>
        </div>

        <div>
            <label for="message" class="block text-sm font-medium text-gray-700 mb-1">Message to Owner (Optional)</label>
            <textarea id="message" name="message" rows="3" 
                      class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500" 
                      placeholder="Add a message for the owner..."></textarea>
        </div>

        <button type="submit" class="w-full bg-green-600 text-white p-3 rounded-lg font-semibold hover:bg-green-700 transition duration-150">
            Request Booking
        </button>
    </form>

    {% if show_waitlist %}
    <div class="mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
        <h3 class="font-semibold text-yellow-800 mb-2">Join Waitlist</h3>
        <p class="text-sm text-yellow-700 mb-4">This time slot is unavailable. Join the waitlist to be notified when it becomes available.</p>
        <form method="POST" action="{{ url_for('bookings.join_waitlist', resource_id=resource.resource_id) }}" class="space-y-3">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
            <div class="grid grid-cols-2 gap-3">
                <input type="datetime-local" name="preferred_start" placeholder="Preferred start" class="p-2 border rounded">
                <input type="datetime-local" name="preferred_end" placeholder="Preferred end" class="p-2 border rounded">
            </div>
            <button type="submit" class="w-full bg-yellow-600 text-white p-2 rounded hover:bg-yellow-700">
                Join Waitlist
            </button>
        </form>
    </div>
    {% endif %}

    <div class="mt-6">
        <a href="{{ url_for('resources.resource_detail', resource_id=resource.resource_id) }}" 
           class="text-indigo-600 hover:text-indigo-700">‚Üê Back to Resource</a>
    </div>
</div>
{% endblock %}

